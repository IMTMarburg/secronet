<script lang="ts">
  import { onMount, onDestroy, createEventDispatcher } from "svelte";
  import { browser } from "$app/environment";
  import Tree from "$lib/components/Tree.svelte";

  import Toggler from "$lib/components/Toggler.svelte";

  import DatasetAutoComplete from "$lib/components/DatasetAutoComplete.svelte";
  import { base } from "$app/paths";

  export let data;

<<<<<<< HEAD
  let paths = ["A/b/c", "A/b/d", "E/f/g"];

  // Function to convert paths into a tree structure
  function buildTree(paths) {
    const root = {};
    paths.forEach((path) => {
      let node = root;
      path.split("/").forEach((part) => {
        node[part] = node[part] || {};
        node = node[part];
      });
    });
    return root;
  }


  // Building the tree from paths
  let tree = buildTree(data.datasets.map((x) => x.name));
  console.log(tree);
=======
  import Tree from "svelte-tree";
  function addPath(tree, path) {
    let currentLevel = tree;
    path.split("/").forEach((part, index, array) => {
      let existingPath = currentLevel.find((child) => child.name === part);
      if (!existingPath) {
        existingPath = { name: part, children: [], path: path };
        currentLevel.push(existingPath);
      }

      if (index === array.length - 1) {
        existingPath.leaf = true;
      } else {
        currentLevel = existingPath.children;
      }
    });
  }

  function pathsToTree(paths) {
    const tree = [];
    paths.forEach((path) => addPath(tree, path));
    return tree;
  }
  let tree = pathsToTree(data.datasets.map((x) => x.name));
>>>>>>> 9be8bf1 (tree view for datasets)
</script>

<h2>Dataset selector</h2>

<<<<<<< HEAD
<ul>
  {#each data.datasets as dataset}
    <li><a href="jitter?dataset={dataset.name}">{dataset.name}</a></li>
  {/each}
</ul>

<Tree node={tree} />


=======
<Tree {tree} let:node>
  <div class="name">
    {#if node.leaf}
      <a href="jitter?dataset={node.path}">{node.name}</a>
    {:else}
      {@html node.name}
    {/if}
  </div>
</Tree>
>>>>>>> 9be8bf1 (tree view for datasets)
